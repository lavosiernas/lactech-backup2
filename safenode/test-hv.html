<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste SafeNode HV</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        form {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        input, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            box-sizing: border-box;
        }
        button {
            background: #000;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
        button:hover {
            background: #333;
        }
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Teste SafeNode Human Verification</h1>
    
    <div class="info">
        <strong>Instruções:</strong>
        <ol>
            <li>Substitua 'SUA_API_KEY_AQUI' pela sua API key real</li>
            <li>Substitua 'http://localhost/safenode' pela URL base do seu SafeNode</li>
            <li>Abra o console do navegador (F12) para ver os logs</li>
            <li>A caixa de verificação deve aparecer acima do botão de submit</li>
        </ol>
    </div>
    
    <form id="testForm" method="POST" action="#">
        <h2>Formulário de Teste</h2>
        <input type="text" name="nome" placeholder="Nome" required>
        <input type="email" name="email" placeholder="Email" required>
        <button type="submit">Enviar</button>
    </form>
    
    <div id="status"></div>
    
    <!-- SafeNode Human Verification SDK -->
    <script src="sdk/safenode-hv.js"></script>
    <script>
        (function() {
            // CONFIGURAÇÃO - ALTERE AQUI
            const apiKey = 'SUA_API_KEY_AQUI'; // Substitua pela sua API key
            const apiUrl = 'http://localhost/safenode/api/sdk'; // Substitua pela URL base do seu SafeNode
            
            console.log('SafeNode HV: Inicializando teste...');
            console.log('SafeNode HV: API Key:', apiKey.substring(0, 10) + '...');
            console.log('SafeNode HV: API URL:', apiUrl);
            
            const hv = new SafeNodeHV(apiUrl, apiKey);
            
            const statusDiv = document.getElementById('status');
            
            hv.init().then(() => {
                console.log('SafeNode HV: Inicializado com sucesso!');
                statusDiv.innerHTML = '<div class="info">✅ SDK inicializado com sucesso! A caixa de verificação deve aparecer acima do botão.</div>';
                
                // Anexar ao formulário
                hv.attachToForm('#testForm');
                
                // Interceptar submit
                document.getElementById('testForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const submitBtn = e.target.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    try {
                        submitBtn.disabled = true;
                        submitBtn.textContent = 'Validando...';
                        
                        const isValid = await hv.validateForm('#testForm');
                        
                        if (isValid) {
                            statusDiv.innerHTML = '<div class="info">✅ Verificação bem-sucedida! Formulário seria enviado agora.</div>';
                            console.log('SafeNode HV: Validação bem-sucedida!');
                            // Aqui você enviaria o formulário normalmente
                            // e.target.submit();
                        }
                    } catch (error) {
                        console.error('SafeNode HV: Erro na validação:', error);
                        statusDiv.innerHTML = '<div class="error">❌ Erro: ' + error.message + '</div>';
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                    }
                });
            }).catch((error) => {
                console.error('SafeNode HV: Erro ao inicializar:', error);
                statusDiv.innerHTML = '<div class="error">❌ Erro ao inicializar: ' + error.message + '</div>';
            });
        })();
    </script>
</body>
</html>

